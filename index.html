<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8">
<title>RTCI Admit Card Generator</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.3/html2pdf.bundle.min.js"></script>
<style>
  body { font-family: Arial, sans-serif; background: #f4f4f4; text-align: center; padding: 30px; }
  .container { background: white; padding: 20px; border-radius: 8px; display: inline-block; }
  input { padding: 8px; font-size: 16px; margin-top: 10px; width: 200px; }
  button { padding: 8px 16px; font-size: 16px; margin-left: 10px; }
  .card { margin-top: 20px; border: 1px solid #ccc; padding: 15px; width: 300px; text-align: left; background: #fff; }
</style>
</head>
<body>

<div class="container">
  <h2>Admit Card Generate</h2>
  <input type="text" id="rollNo" placeholder="Roll No">
  <button onclick="generateCard()">Generate PDF</button>

  <div id="cardArea" style="display:none;">
    <div class="card" id="admitCard">
      <h3>RTCI CCC Test 2025</h3>
      <p><strong>Roll No:</strong> <span id="cRoll"></span></p>
      <p><strong>Name:</strong> <span id="cName"></span></p>
      <p><strong>Father:</strong> <span id="cFather"></span></p>
      <p><strong>Course:</strong> <span id="cCourse"></span></p>
      <p><strong>Date:</strong> <span id="cDate"></span></p>
      <p><strong>Time:</strong> <span id="cTime"></span></p>
    </div>
  </div>
</div>

<script>
const sheetID = "1Gb5R718e-3YtPIjva6mqINQNUQCUzgp9ogA4xbja_zU";
const sheetName = "Sheet1";
const dataURL = `https://opensheet.elk.sh/${sheetID}/${sheetName}`;

async function generateCard() {
  const roll = document.getElementById("rollNo").value.trim();
  const cardDiv = document.getElementById("cardArea");
  const result = await (await fetch(dataURL)).json();
  const student = result.find(r => r["Roll No"] === roll);

  if (!student) {
    alert("Roll No not found!");
    return;
  }

  document.getElementById("cRoll").innerText = student["Roll No"];
  document.getElementById("cName").innerText = student["Name"];
  document.getElementById("cFather").innerText = student["Father Name"];
  document.getElementById("cCourse").innerText = student["Course"];
  document.getElementById("cDate").innerText = student["Exam Date"];
  document.getElementById("cTime").innerText = student["Exam Time"];

  cardDiv.style.display = "block";
  html2pdf().set({ margin: 0.5, filename: `${roll}_AdmitCard.pdf` }).from(document.getElementById("admitCard")).save();
}
</script>

</body>
</html>
