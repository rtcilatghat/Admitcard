<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Admit Card Download</title>
  <style>
    body { font-family: Arial, sans-serif; text-align: center; margin-top: 50px; }
    input { padding: 8px; width: 200px; }
    button { padding: 8px 12px; margin-left: 5px; cursor: pointer; }
    table { margin: 20px auto; border-collapse: collapse; width: 80%; display: none; }
    th, td { border: 1px solid #ddd; padding: 8px; }
    th { background-color: #f2f2f2; }
    #downloadBtn { display: none; margin-top: 15px; padding: 8px 16px; background-color: green; color: white; border: none; cursor: pointer; }
  </style>
</head>
<body>

  <h2>Search Your Admit Card</h2>
  <input type="text" id="rollNo" placeholder="Enter Roll Number">
  <button onclick="searchData()">Search</button>

  <table id="resultTable">
    <thead>
      <tr>
        <th>Name</th>
        <th>Father Name</th>
        <th>Course</th>
        <th>Roll No</th>
        <th>Exam Date</th>
        <th>Exam Time</th>
      </tr>
    </thead>
    <tbody id="resultBody"></tbody>
  </table>

  <button id="downloadBtn" onclick="downloadPDF()">Download Admit Card</button>

<script>
  const sheetUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vT-FnP7dIxjn3QNbsLolSKfXQYXlYfPWzMQShFjq71C9pOjO9Jfzi2s4UHgwJ842caxfDk6fsInkMhb/pub?output=csv";
  let selectedData = null;

  function searchData() {
    const roll = document.getElementById("rollNo").value.trim();
    if (!roll) {
      alert("Please enter roll number");
      return;
    }

    fetch(sheetUrl)
      .then(res => res.text())
      .then(csv => {
        const rows = csv.split("\n").map(row => row.split(","));
        const header = rows[0];
        const dataRows = rows.slice(1);

        let found = false;
        for (let row of dataRows) {
          if (row[3] && row[3].trim() === roll) { 
            document.getElementById("resultBody").innerHTML = `
              <tr>
                <td>${row[0]}</td>
                <td>${row[1]}</td>
                <td>${row[2]}</td>
                <td>${row[3]}</td>
                <td>${row[4]}</td>
                <td>${row[5]}</td>
              </tr>
            `;
            document.getElementById("resultTable").style.display = "table";
            document.getElementById("downloadBtn").style.display = "inline-block";
            selectedData = row;
            found = true;
            break;
          }
        }
        if (!found) {
          alert("Result not found");
          document.getElementById("resultTable").style.display = "none";
          document.getElementById("downloadBtn").style.display = "none";
        }
      });
  }

  function downloadPDF() {
    if (!selectedData) return;
    const roll = selectedData[3];
    // यहां अपने PDF फाइल का नाम सेट करें (उदाहरण: roll no के नाम से)
    const pdfUrl = `admitcards/${roll}.pdf`; 
    window.open(pdfUrl, "_blank");
  }
</script>

</body>
</html>
