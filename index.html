<!DOCTYPE html>
<html>
<head>
  <title>Admit Card Search</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 30px; }
    input, button { padding: 8px; margin: 5px; }
    table { border-collapse: collapse; margin-top: 20px; width: 100%; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
    #result { display: none; }
  </style>
</head>
<body>

<h2>Admit Card Search</h2>
<input type="text" id="rollNo" placeholder="Enter Roll No">
<button onclick="searchData()">Search</button>

<div id="result">
  <h3>Admit Card Details</h3>
  <table id="dataTable"></table>
  <br>
  <button onclick="downloadPDF()">Download PDF</button>
</div>

<script>
const sheetUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vT-FnP7dIxjn3QNbsLolSKfXQYXlYfPWzMQShFjq71C9pOjO9Jfzi2s4UHgwJ842caxfDk6fsInkMhb/pub?output=csv';

let sheetData = [];

fetch(sheetUrl)
  .then(res => res.text())
  .then(text => {
    sheetData = text.split('\n').map(row => row.split(','));
  });

function searchData() {
  const rollNo = document.getElementById('rollNo').value.trim();
  const resultDiv = document.getElementById('result');
  const table = document.getElementById('dataTable');
  table.innerHTML = '';

  const headers = sheetData[0];
  const row = sheetData.find(r => r[0].trim() === rollNo);

  if (row) {
    let headerRow = '<tr>' + headers.map(h => `<th>${h}</th>`).join('') + '</tr>';
    let dataRow = '<tr>' + row.map(d => `<td>${d}</td>`).join('') + '</tr>';
    table.innerHTML = headerRow + dataRow;
    resultDiv.style.display = 'block';
  } else {
    alert('Roll No not found');
    resultDiv.style.display = 'none';
  }
}

function downloadPDF() {
  const rollNo = document.getElementById('rollNo').value.trim();
  const pdfUrl = `admitcards/${rollNo}.pdf`; // अपने PDF फ़ोल्डर का path
  window.open(pdfUrl, '_blank');
}
</script>

</body>
</html>
